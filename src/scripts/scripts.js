/*

  me when the code starts from the first line with no imports, intros, overtures:
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⠀⢀⠀⠄⡀⠄⠠⢀⠐⡀⠆⡐⠀⢆⠰⢀⢂⠐⡂⠔
⠀⠀⠸⣦⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠄⠂⠀⢁⠈⢀⠁⡈⢀⠂⠐⡈⠄⡐⠠⠁⢂⡰⠁⡐⠠⠃⠌⡐⠠⠊⡔⢡⠉
⠀⠀⠀⠸⣿⣦⠢⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠀⠂⠀⠄⠁⠀⠀⠂⠀⠀⠄⠈⠐⢠⠐⠠⠁⡌⠂⢠⠐⠈⠡⠈⠐⠀⠃⠑⠈⠀⣴
⠀⠀⠀⠀⣈⣿⣶⣤⣆⣄⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡀⠀⠀⢀⠀⠄⠀⠀⡀⠀⢀⠠⠀⡀⠀⡀⠀⠤⠀⡀⠄⠠⢀⠀⢄⠠⢀⠄⣀⣶⣿⣿
⠀⠀⠀⠀⠐⣻⣿⣿⣿⣿⣿⣿⣶⣤⣀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⠀⡀⠠⠈⡀⠠⢀⠠⠐⡠⢀⠃⢀⠜⢀⠖⠀⢂⡁⠆⣜⣈⣮⣷⣾⣿⣿⣿⣿
⠀⠀⠀⠀⠀⠒⠤⢭⣙⢿⣿⣿⣿⣿⣿⣿⣶⣤⣀⣀⣀⡀⡀⢀⠀⠀⢀⣴⣶⣰⣼⣇⠈⠄⢧⡬⡖⢾⣦⣾⣷⣷⣂⣐⣵⣾⣿⣶⣿⣴⣥⣤⣧⣶⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
⠀⠀⠀⠀⠀⠀⠀⢲⠶⠂⠉⡻⢿⣿⣿⣿⣿⣿⡻⣿⣿⣿⠰⣷⣶⣿⣿⣷⣌⣩⣶⣿⡐⠸⠀⠀⢰⣼⣏⢀⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿
⠀⠀⠀⠀⠀⠀⠀⠤⢤⣠⢂⡠⣼⢿⡿⠟⢹⣿⣿⣿⡿⣻⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣤⣼⠁⣼⣿⣿⣷⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡛⠀
⠀⠀⠀⠀⠀⠀⠀⠈⠀⠀⠀⠩⣿⣿⣿⣿⣿⣿⣿⣿⣯⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠿⠿⢆⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡀⣴⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡏⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠐⡚⠟⠋⠁⠀⠀⠀⠈⠙⠛⢿⣿⣿⣿⣿⣿⣿⢿⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠿⠛⠉⠀⠀⠀⠉⠉⠻⢿⣿⣿⣿⡗⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⢠⡒⡡⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⠻⣿⣿⣿⣿⡌⠀⣼⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠋⠁⠀⠀⠀⠀⠀⠀⠀⠀⣢⣾⣿⣿⣿⡇⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠃⢀⡔⠄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⢿⣿⣿⡇⠠⢂⣻⣿⣿⡿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡟⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠘⣿⣷⣯⣹⣋⠂⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⢠⣾⡏⠀⠀⠀⠀⠀⠀⠀⠀⠠⡄⠀⠀⠀⢸⣿⣿⡇⢠⢹⣿⣷⣾⠁⢽⣿⣿⣿⣿⣿⣿⣿⣿⠀⠀⠀⠀⠀⠀⠀⠀⠄⠀⠀⠀⠀⢸⣿⣿⣿⣿⡴⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⣿⣿⣧⠄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⣿⣿⡧⠏⣼⣿⣿⠇⠀⢾⣿⣿⣿⣿⣿⣿⣿⣿⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣹⣿⣿⣿⣿⡧⢄⡀⢤
⠀⠀⠀⠀⠀⠀⠀⠤⢿⣿⣿⣷⣔⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠠⢿⠟⠁⡈⢍⠋⠟⣛⣶⣾⣿⣿⣿⣿⣿⣿⣿⡇⠃⡄⡀⠀⠀⠀⠀⠀⠀⠀⣀⣤⣾⣿⣿⣿⣿⡿⢻⡀⠈⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠌⡨⠩⠛⠻⢿⣿⣷⣶⣶⣶⣶⣶⡏⠀⠀⠐⠈⢀⠔⣰⡠⠀⣲⣽⣿⣿⣿⡏⢨⡟⠿⣿⣯⠐⢀⠀⣿⣿⣿⣷⣶⣷⣿⣿⣿⠿⣿⣿⣿⣿⣿⣿⣾⣿⡖⠀
⠀⠀⠀⠀⠀⠀⠰⠀⠠⡐⢣⢌⣩⠄⠀⠙⠻⣿⣿⣿⡿⠃⠐⠀⢀⠐⠈⠄⢑⠒⣦⣿⣿⣿⣿⣯⣯⣿⣯⠀⣹⣏⠄⠆⡉⢜⣿⣿⡿⠿⠛⢿⣿⣿⣿⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿
⠀⠀⠀⠀⠀⠀⠈⠆⠁⠐⠂⢆⠴⠠⡊⠆⠪⠘⠋⡋⢁⠀⠄⠂⢀⠢⠈⡐⠈⣼⣿⣿⣿⣿⣿⣿⣿⣿⣷⣶⡿⣿⣦⣤⡥⡌⠹⢿⠿⡄⠄⢊⢹⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠁⠈⠠⡈⡕⡑⠨⡁⢋⠄⣂⠢⢂⡰⢈⠠⢀⠁⣀⣞⣿⣿⣿⣿⣿⣿⣿⣿⡿⣿⣿⣷⣿⣿⣿⣷⣾⣬⣿⣿⣿⣿⣿⣽⣿⣿⣿⣿⣿⣿⣿⣿⡿⠛⠿⣿
⠀⠀⠀⠀⠀⠀⠀⠀⠠⠐⠈⡀⠐⠀⠌⣁⠒⠆⡉⣘⣨⣾⣶⠈⠄⠂⠄⡡⢌⢡⣽⣿⣿⣿⡏⠁⣀⢰⣤⡀⠿⣿⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡟⢿⣿⣿⣷⣀⣴⣿
⠀⠀⠀⠀⠀⠀⠀⠀⠀⢍⢢⠑⡌⠒⠨⢐⡁⡁⠐⣺⣿⣿⣷⣿⣦⣀⡀⢀⠈⠈⠉⢛⠻⠋⠀⠐⠂⠂⠈⠐⣈⣸⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣾⣏⣿⣿⣿⣿⡿
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠢⢋⠄⠴⠤⢨⡀⠀⠉⠁⡻⠙⣻⣿⣿⣿⣿⣶⣤⠀⠀⢁⡲⠆⢒⢩⡚⣤⣷⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣍⣿⣿⠏⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠋⠂⠎⠁⡠⣷⣶⣶⣤⣧⣴⣾⣿⣿⣿⣿⣿⣿⣇⢀⠒⡴⠁⡀⠋⢹⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡟⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠠⠄⠒⠠⠠⢠⢠⠁⠁⠉⠉⠉⠉⢸⣿⣿⣿⣿⣿⣿⣷⡅⠘⠁⠐⢠⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡷⠀⠀⠐
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠠⠀⣀⠄⡈⠠⠿⠈⠾⢷⣰⡴⣾⣿⣿⣿⣿⣿⣿⣿⣿⣄⠀⠠⢾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣇⠀⢈⢼
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠋⠁⠊⡀⠀⠁⠇⠂⠐⢀⠀⢓⣻⣉⢹⣿⣿⣿⣿⣿⠓⠀⣐⢹⣻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠷⡩⢲⢭
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡀⡁⡷⣵⣦⣦⣀⠐⠀⠂⠂⡂⡍⠿⢛⣿⡿⣽⣿⠛⠋⠁⡠⣐⠒⠌⠻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡀⠁⠀⠆⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡐⢆⣿⣿⣿⣿⣿⣿⣿⣷⣦⣡⡀⢄⠂⠉⠈⠘⢉⢐⣤⣠⣰⣷⣾⣷⣮⣤⣼⣹⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡏⠑⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡑⠓⠂⣯⣿⣿⣿⣿⣿⣿⣿⣿⣿⣾⣤⢴⡞⡿⡻⡿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡃⠀⠀⠀⠐
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⡀⠃⠖⢟⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣧⣾⣷⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠏⠋⠛⡋⠆⠀⠀⠀

*/

export function setCookie(key, value)
{
    new Promise(() => document.cookie = `${key}=${value}; max-age=7776000; path=/`).catch(function ignore() { });
}

export function cookiesHas(text)
{
    return document.cookie.toString().includes(text);
}


export const switchMode = (setOption, option, valueA, valueB) => setOption(option === valueB ? valueA : valueB);


export function groupEntries(entries)
{
    const series = new Set();

    for (let i = 0; i < entries.length; i++)
    {
        series.add(entries[i].media.seriesId);
    }

    const copy = [];

    for (const group of series)
    {
        const items = entries.filter(x => x.media.seriesId === group);
        for (let j = 0; j < items.length; j++)
        {
            copy.push(items[j]);
        }
        copy.push('-');
    }

    copy.pop();

    return copy;
}


export function tipShow(element, data)
{
    let hoverbox = element.getBoundingClientRect();
    let body = document.body.getBoundingClientRect();
    let tip = document.getElementById("tip");
    let edge = document.querySelector(".tip-rect-ref").getBoundingClientRect().right - 20;

    tip.innerHTML = data;
    tip.style.display = "block";

    let tipbox = tip.getBoundingClientRect();
    let top = hoverbox.top - body.top - 12 - tipbox.height;
    let left = hoverbox.left - body.left;
    if (left + tipbox.width > edge) left -= (tipbox.width + 5);

    tip.style.top = top + "px";
    tip.style.left = left + "px";
}

export function tipShowA3M(element, data)
{
    let day = element.parentElement.getBoundingClientRect();
    let body = document.body.getBoundingClientRect();
    let main = document.querySelector("main").getBoundingClientRect();
    let tip = document.getElementById("tip");

    tip.innerHTML = data;
    tip.style.display = "block";

    let tipbox = tip.getBoundingClientRect();
    let top = day.bottom + 18 - body.top - main.top;
    let left = day.left - ((tipbox.width - day.width) / 2) - main.left;

    tip.style.top = top + "px";
    tip.style.left = left + "px";
}

export function tipHide()
{
    document.getElementById("tip").style.display = "none";
}